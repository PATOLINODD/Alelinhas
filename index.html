<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./index.css">
    <link rel="stylesheet" href="./styles/menu.css">
    <link rel="stylesheet" href="./styles/flex.css">
    <link rel="stylesheet" href="./styles/components/button.css">
    <link rel="stylesheet" href="./styles/components/popover.css">
    <title>Alelinhas</title>
</head>

<body>
    <audio id="background-music" src="./assets/sounds/background-musics/lofi_background.mp3" autoplay loop></audio>
    <div class="menu flex col justify-evenly align-center slide-up-in" data-delay="0.4">
        <h2 class="slide-up-in" data-delay="1.5">Alelinhas Game</h2>
        <ul class="flex col justify-center align-center gap-1">
            <li class="slide-up-in" data-delay="1.3">
                <button id="play" data-redirect="game.html">SALVAR ALELINHAS!</button>
            </li>
            <li class="slide-up-in" data-delay="1.1">
                <button id="store" data-redirect="store.html">Salvar Outras Alelinhas!</button>
            </li>
            <li class="slide-up-in" data-delay="0.9">
                <button id="iventory" data-redirect="iventory.html">Alelinhas Salvas</button>
            </li>
            <li class="slide-up-in" data-delay="0.7">
                <input type="button" value="Opções" popovertarget="options">
            </li>
            <li class="slide-up-in" data-delay="0.5">
                <button id="aboutme" data-redirect="aboutme.html">Quem Fez Esse Jogo?</button>
            </li>
        </ul>
    </div>

    <!-- INIT UTILS -->
    <script src="./scripts/utils/random.js"></script>
    <script src="./scripts/utils/audio.js"></script>
    <script src="./scripts/utils/local.js"></script>

    <!-- INIT UI -->
    <script src="./scripts/UI/components/button.js"></script>

    <!-- INIT ANIMATIONS -->
    <script src="./scripts/animations/whoosh-animation.js"></script>
    <script src="./scripts/animations/finish-animations.js"></script>

    <!-- INIT CONTROLLERS -->
    <script src="./scripts/controllers/audio-controller.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            let lists = document.querySelectorAll('.slide-up-in');// take the element from the dom

            const audioContext = audioController(document.querySelector('#background-music'), document.querySelector('#volume'));

            document.addEventListener('click', () => {
                if (audioContext.state === "suspended") audioContext.resume(); //It is not playing here when the user clicks on the DOM. I need to understand why
            })

            // Redirect the user to the page that the button is pointing to.
            document.querySelectorAll('button').forEach(button => {
                button.addEventListener('click', async () => {
                    const redirect = button.dataset.redirect;
                    window.location.href = redirect;
                })
            })

            // Begin the animation and store it into the animations array.
            for (let i = lists.length - 1; i >= 0; i--) {
                const li = lists[i];
                li.style.zIndex = lists.length - i + 1;
                const delay = Number(li.dataset.delay);
                const whoosh = whooshAnimation(li, delay);
                animations.push({ el: li, ani: whoosh });
            }
        })



    </script>
</body>

</html>